<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>IA - Central de Opera√ß√µes v5.2</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700&family=Rajdhani:wght@500;700&display=swap" rel="stylesheet">
    <style>
        .level-bar { width: 100%; height: 8px; background: #222; border-radius: 4px; margin-top: 10px; overflow: hidden; }
        .level-progress { height: 100%; background: var(--neon); width: 0%; transition: 0.5s; box-shadow: 0 0 10px var(--neon); }
        
        .game-modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.98); z-index: 200; display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 20px; }
        .wire-board { width: 280px; height: 250px; background: #0a0a0a; border: 2px solid #333; border-radius: 10px; position: relative; }
        .wire-node { width: 45px; height: 15px; border-radius: 4px; position: absolute; cursor: pointer; transition: 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
        .wire-node.connected { transform: translateX(200px); box-shadow: 0 0 15px currentColor; }
        
        .social-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-top: 20px; }
        .social-btn { padding: 12px; border-radius: 8px; text-align: center; font-size: 1.2rem; background: #111; border: 1px solid #333; color: #fff; text-decoration: none; }
        
        .ads-box { width: 100%; background: #080808; border: 1px dashed #333; padding: 15px; text-align: center; border-radius: 8px; margin: 15px 0; }
        .hidden { display: none !important; }
    </style>
</head>
<body>

    <div class="header">üéÆ CENTRAL IA v5.2</div>

    <div class="container">
        <div class="ads-box">
            <small style="color:#444; display:block; margin-bottom:5px;">PATROCINADO</small>
            <div style="color:#222; font-family:'Orbitron'; font-size:0.8rem;">ESPA√áO PUBLICIT√ÅRIO 01</div>
        </div>

        <div class="card">
            <div style="display: flex; justify-content: space-between; align-items: center;">
                <span style="font-family:'Orbitron'; font-size:0.7rem; color:var(--neon);">N√çVEL <span id="u-lvl">1</span></span>
                <span style="font-size:0.7rem; color:#777;"><span id="u-xp">0</span> / 100 XP</span>
            </div>
            <div class="level-bar"><div id="lvl-fill" class="level-progress"></div></div>
        </div>

        <div class="card" onclick="openGame('fio')">
            <div style="display: flex; align-items: center; gap: 15px;">
                <div style="font-size: 1.8rem;">‚ö°</div>
                <div style="flex-grow: 1;">
                    <h3 style="font-family: 'Orbitron'; color: var(--neon); font-size: 0.8rem;">DESCRIPTOGRAFAR</h3>
                    <p style="font-size: 0.65rem; color: #666;">Conecte os fios para ganhar XP.</p>
                </div>
                <div style="color:var(--green); font-size:0.7rem;">+10 XP</div>
            </div>
        </div>

        <div class="card" onclick="openGame('hack')">
            <div style="display: flex; align-items: center; gap: 15px;">
                <div style="font-size: 1.8rem;">üíª</div>
                <div style="flex-grow: 1;">
                    <h3 style="font-family: 'Orbitron'; color: var(--green); font-size: 0.8rem;">HACKEANDO</h3>
                    <p style="font-size: 0.65rem; color: #666;">Infiltre-se no sistema (Tron Runner).</p>
                </div>
                <div style="color:var(--green); font-size:0.7rem;">+R$ 0,05</div>
            </div>
        </div>

        <div class="social-grid">
            <a href="https://facebook.com" target="_blank" class="social-btn">üìò</a>
            <a href="https://instagram.com" target="_blank" class="social-btn">üì∏</a>
            <a href="https://tiktok.com" target="_blank" class="social-btn">üéµ</a>
        </div>

        <div class="ads-box">
            <div style="color:#222; font-family:'Orbitron'; font-size:0.8rem;">ESPA√áO PUBLICIT√ÅRIO 02</div>
            <small style="color:#444; display:block; margin-top:5px;">ADS v5.2</small>
        </div>

        <button onclick="window.location.href='index.html'" class="btn-outline" style="margin-top: 10px;">SAIR DA CENTRAL</button>
    </div>

    <div id="game-overlay" class="game-modal hidden">
        <div id="game-content" style="width:100%; display:flex; flex-direction:column; align-items:center;"></div>
        <button onclick="closeGame()" class="btn-outline" style="width:150px; margin-top:30px;">FECHAR JOGO</button>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js";
        import { getFirestore, doc, onSnapshot, updateDoc, increment } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore.js";
        import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-auth.js";

        const firebaseConfig = {
            apiKey: "AIzaSyAYO5RWaJy5y7r7jvzFk3wq-ByqM_dWWO8",
            authDomain: "minharifadigital.firebaseapp.com",
            projectId: "minharifadigital",
            storageBucket: "minharifadigital.firebasestorage.app",
            messagingSenderId: "59630725905",
            appId: "1:59630725905:web:396c8cfca385dc3d957ab0"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const auth = getAuth(app);
        let user, currentXP = 0;

        onAuthStateChanged(auth, (u) => {
            if(u) {
                user = u;
                onSnapshot(doc(db, "usuarios", u.uid), (snap) => {
                    const data = snap.data();
                    currentXP = data.xp || 0;
                    const level = Math.floor(currentXP / 100) + 1;
                    const progress = currentXP % 100;
                    
                    document.getElementById('u-xp').innerText = currentXP;
                    document.getElementById('u-lvl').innerText = level;
                    document.getElementById('lvl-fill').style.width = progress + "%";
                });
            } else { window.location.href = 'login.html'; }
        });

        window.openGame = (tipo) => {
            const content = document.getElementById('game-content');
            document.getElementById('game-overlay').classList.remove('hidden');

            if(tipo === 'fio') {
                content.innerHTML = `
                    <h2 style="color:var(--neon); font-family:'Orbitron'; margin-bottom:20px;">FIA√á√ÉO IA</h2>
                    <div class="wire-board">
                        <div class="wire-node" style="background:#ff0055; top:40px; left:15px;" onclick="connectWire(this)"></div>
                        <div class="wire-node" style="background:#00f2ff; top:115px; left:15px;" onclick="connectWire(this)"></div>
                        <div class="wire-node" style="background:#00ff88; top:190px; left:15px;" onclick="connectWire(this)"></div>
                    </div>
                    <p id="game-status" style="margin-top:20px; font-size:0.8rem; color:#555;">Conecte todos os terminais</p>
                `;
            } else {
                content.innerHTML = `
                    <h2 style="color:var(--green); font-family:'Orbitron';">HACKEANDO...</h2>
                    <div style="width:200px; height:100px; border:1px solid #222; margin:20px; overflow:hidden; position:relative;">
                        <div id="runner" style="position:absolute; bottom:10px; left:10px; font-size:1.5rem;">üèÉ</div>
                        <div style="position:absolute; bottom:10px; right:-50px; font-size:1.2rem; animation: slide 2s infinite linear;">üöß</div>
                    </div>
                    <button class="btn-primary" onclick="jump()">PULAR OBST√ÅCULO</button>
                    <style> @keyframes slide { from { right: -50px; } to { right: 250px; } } </style>
                `;
            }
        };

        let wiresConnected = 0;
        window.connectWire = async (el) => {
            if(el.classList.contains('connected')) return;
            el.classList.add('connected');
            wiresConnected++;
            if(wiresConnected === 3) {
                document.getElementById('game-status').innerText = "CONEX√ÉO ESTABELECIDA! +10 XP";
                document.getElementById('game-status').style.color = "var(--green)";
                await updateDoc(doc(db, "usuarios", user.uid), { xp: increment(10) });
                setTimeout(closeGame, 1500);
            }
        };

        window.jump = async () => {
            const runner = document.getElementById('runner');
            runner.style.bottom = "50px";
            setTimeout(() => { 
                runner.style.bottom = "10px";
                updateDoc(doc(db, "usuarios", user.uid), { saldo: increment(0.01) });
            }, 300);
        };

        window.closeGame = () => {
            document.getElementById('game-overlay').classList.add('hidden');
            wiresConnected = 0;
        };
    </script>
</body>
</html>
