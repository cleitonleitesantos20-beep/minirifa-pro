<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Central IA v5.6.0 - Recompensas</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700&family=Rajdhani:wght@500;700&display=swap" rel="stylesheet">
    <style>
        :root { --neon: #00f2ff; --pink: #ff0055; --green: #00ff88; --dark: #0a0a0a; }
        body { background: #000; color: #fff; font-family: 'Rajdhani'; margin: 0; overflow-x: hidden; }
        
        .header { height: 60px; display: flex; align-items: center; justify-content: center; border-bottom: 1px solid #111; font-family: 'Orbitron'; font-size: 0.7rem; position: relative; }
        .btn-back { position: absolute; left: 15px; background: none; border: none; color: var(--neon); font-size: 1.2rem; cursor: pointer; }

        .container { padding: 15px; }
        .ads-space { background: rgba(255,255,255,0.02); border: 1px dashed #222; color: #333; text-align: center; padding: 10px; font-family: 'Orbitron'; font-size: 0.45rem; margin: 10px 0; border-radius: 8px; }

        /* Check-in Diário */
        .daily-section { background: var(--dark); padding: 15px; border-radius: 15px; border: 1px solid #1a1a1a; margin-bottom: 15px; }
        .daily-grid { display: flex; justify-content: space-between; margin-top: 10px; }
        .day-dot { width: 30px; height: 30px; border-radius: 50%; border: 1px solid #222; display: flex; align-items: center; justify-content: center; font-size: 0.5rem; font-family: 'Orbitron'; color: #444; }
        .day-dot.active { border-color: var(--green); color: var(--green); box-shadow: 0 0 10px rgba(0,255,136,0.2); }
        .day-dot.done { background: var(--green); color: #000; border: none; }
        .btn-checkin { width: 100%; margin-top: 12px; background: #111; border: 1px solid var(--green); color: var(--green); padding: 10px; border-radius: 8px; font-family: 'Orbitron'; font-size: 0.6rem; cursor: pointer; }

        /* Barra de Progresso (1000 XP) */
        .lvl-section { background: var(--dark); padding: 15px; border-radius: 15px; border: 1px solid #1a1a1a; margin-bottom: 15px; }
        .progress-container { background: #111; height: 10px; border-radius: 5px; margin-top: 10px; overflow: hidden; border: 1px solid #222; }
        .progress-bar { height: 100%; background: linear-gradient(90deg, var(--neon), var(--green)); width: 0%; transition: 0.4s; }

        /* Games */
        .game-card { background: var(--dark); border: 1px solid #1a1a1a; border-radius: 20px; padding: 20px; margin-bottom: 15px; position: relative; }
        .game-card h3 { font-family: 'Orbitron'; font-size: 0.75rem; margin: 0 0 5px 0; color: var(--neon); }
        .screen { background: #000; border: 1px solid #111; border-radius: 10px; height: 140px; margin-top: 10px; position: relative; display: flex; flex-direction: column; align-items: center; justify-content: center; overflow: hidden; cursor: pointer; }

        /* Ad Overlay */
        #ad-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #000; z-index: 1000; display: none; flex-direction: column; align-items: center; justify-content: center; }
        
        #cube-hero { width: 20px; height: 20px; background: var(--neon); position: absolute; bottom: 20px; left: 40px; transition: 0.3s; box-shadow: 0 0 10px var(--neon); }
        .obstacle { width: 20px; height: 35px; background: var(--pink); position: absolute; right: -30px; bottom: 20px; }
    </style>
</head>
<body>

    <div id="ad-overlay">
        <div style="font-family:'Orbitron'; color:var(--neon); margin-bottom:20px;">CARREGANDO VÍDEO...</div>
        <div style="width:250px; height:150px; border:1px dashed #333; display:flex; align-items:center; justify-content:center; text-align:center; padding:20px; font-size:0.8rem; color:#444;">
            SUA PROPAGANDA AQUI<br>(Aguarde 30s)
        </div>
        <div id="ad-timer" style="font-family:'Orbitron'; font-size:2rem; margin-top:20px; color:var(--pink);">30</div>
    </div>

    <div class="header">
        <button class="btn-back" onclick="window.location.href='index.html'">⬅</button>
        CENTRAL IA v5.6.0
    </div>

    <div class="container">
        
        <div class="daily-section">
            <div style="font-family:'Orbitron'; font-size:0.55rem; color:#888;">CHECK-IN SEMANAL (+R$ 0,02)</div>
            <div class="daily-grid" id="daily-dots">
                <div class="day-dot" data-day="1">S</div>
                <div class="day-dot" data-day="2">T</div>
                <div class="day-dot" data-day="3">Q</div>
                <div class="day-dot" data-day="4">Q</div>
                <div class="day-dot" data-day="5">S</div>
                <div class="day-dot" data-day="6">S</div>
                <div class="day-dot" data-day="0">D</div>
            </div>
            <button class="btn-checkin" id="btn-do-checkin" onclick="processCheckIn()">FAZER CHECK-IN DE HOJE</button>
        </div>

        <div class="ads-space">SUA PROPAGANDA AQUI</div>

        <div class="lvl-section">
            <div style="display: flex; justify-content: space-between; font-family: 'Orbitron'; font-size: 0.55rem;">
                <span id="u-nome">OPERADOR...</span>
                <span style="color: var(--neon);">LEVEL <span id="u-lvl">1</span></span>
            </div>
            <div class="progress-container"><div class="progress-bar" id="xp-bar"></div></div>
            <div style="display:flex; justify-content:space-between; margin-top:5px; font-family:'Orbitron'; font-size:0.45rem; color:#444;">
                <span><span id="xp-num">0</span> / 1000 XP</span>
                <span style="color:var(--green);">BÔNUS: R$ 0,10 / LVL</span>
            </div>
        </div>

        <div class="game-grid">
            <div class="game-card">
                <h3>RUNNER: TOQUE PARA SALTAR (+1 XP)</h3>
                <div class="screen" onclick="jumpCube()">
                    <div id="cube-hero"></div>
                    <div style="position:absolute; bottom:0; width:100%; height:20px; background:#111;"></div>
                </div>
            </div>

            <div class="game-card">
                <h3>EXTRAÇÃO: PRESSIONE (+1 XP)</h3>
                <div class="screen" onmousedown="startHold()" onmouseup="stopHold()" ontouchstart="startHold()" ontouchend="stopHold()">
                    <div id="hold-fill" style="width:0%; height:100%; background:rgba(0,242,255,0.1); position:absolute; left:0;"></div>
                    <div style="font-family:'Orbitron'; font-size:0.6rem; z-index:2; color:var(--neon);">SEGURE PARA CARREGAR</div>
                </div>
            </div>

            <div class="game-card">
                <h3>CÁLCULO RÁPIDO (+1 XP)</h3>
                <div class="screen" style="cursor:default">
                    <div id="math-quest" style="font-family:'Orbitron'; font-size:1.5rem; margin-bottom:10px;">0 + 0</div>
                    <input type="number" id="math-ans" placeholder="?" style="background:#111; border:1px solid var(--neon); color:#fff; width:80px; text-align:center; padding:8px; font-family:'Orbitron';" oninput="checkMath(this)">
                </div>
            </div>
        </div>

        <div class="ads-space">SUA PROPAGANDA AQUI</div>

    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js";
        import { getFirestore, doc, onSnapshot, updateDoc, increment, getDoc } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore.js";
        import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-auth.js";

        const firebaseConfig = {
            apiKey: "AIzaSyAYO5RWaJy5y7r7jvzFk3wq-ByqM_dWWO8",
            authDomain: "minharifadigital.firebaseapp.com",
            projectId: "minharifadigital",
            appId: "1:59630725905:web:396c8cfca385dc3d957ab0"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const auth = getAuth(app);

        let user, currentXP = 0, currentLevel = 1;

        onAuthStateChanged(auth, async (u) => {
            if (u) {
                user = u;
                onSnapshot(doc(db, "usuarios", u.uid), (snap) => {
                    const data = snap.data();
                    if(data) {
                        const newXP = data.xp || 0;
                        const newLevel = Math.floor(newXP / 1000) + 1;
                        if(newLevel > currentLevel) payBonus(0.10, "LEVEL UP!");
                        
                        currentXP = newXP;
                        currentLevel = newLevel;
                        document.getElementById('u-nome').innerText = (data.nome || "User").toUpperCase();
                        document.getElementById('u-lvl').innerText = currentLevel;
                        document.getElementById('xp-bar').style.width = ((currentXP % 1000) / 10) + "%";
                        document.getElementById('xp-num').innerText = Math.floor(currentXP % 1000);
                        
                        updateCheckInUI(data.lastCheckIn);
                    }
                });
            }
        });

        async function addXP(v) { await updateDoc(doc(db, "usuarios", user.uid), { xp: increment(v) }); }
        async function payBonus(v, msg) { 
            await updateDoc(doc(db, "usuarios", user.uid), { saldo: increment(v) });
            if(msg) alert(msg);
        }

        // --- CHECK-IN LOGIC ---
        function updateCheckInUI(lastDate) {
            const today = new Date().toLocaleDateString();
            const dayOfWeek = new Date().getDay();
            const dots = document.querySelectorAll('.day-dot');
            
            dots.forEach(dot => {
                if(parseInt(dot.dataset.day) === dayOfWeek) dot.classList.add('active');
                if(lastDate === today && parseInt(dot.dataset.day) === dayOfWeek) {
                    dot.classList.add('done');
                    document.getElementById('btn-do-checkin').innerText = "CHECK-IN CONCLUÍDO";
                    document.getElementById('btn-do-checkin').disabled = true;
                    document.getElementById('btn-do-checkin').style.opacity = "0.5";
                }
            });
        }

        window.processCheckIn = () => {
            document.getElementById('ad-overlay').style.display = 'flex';
            let timeLeft = 30;
            const timer = setInterval(() => {
                timeLeft--;
                document.getElementById('ad-timer').innerText = timeLeft;
                if(timeLeft <= 0) {
                    clearInterval(timer);
                    finalizeCheckIn();
                }
            }, 1000);
        };

        async function finalizeCheckIn() {
            const today = new Date().toLocaleDateString();
            await updateDoc(doc(db, "usuarios", user.uid), {
                lastCheckIn: today,
                saldo: increment(0.02)
            });
            document.getElementById('ad-overlay').style.display = 'none';
            alert("Check-in realizado! +R$ 0,02");
        }

        // --- GAME: RUNNER ---
        let runActive = false;
        window.jumpCube = () => {
            const hero = document.getElementById('cube-hero');
            if(hero.style.bottom === "80px") return;
            hero.style.bottom = "80px";
            setTimeout(() => { hero.style.bottom = "20px"; }, 400);
            if(!runActive) spawnObstacle();
        };

        function spawnObstacle() {
            runActive = true;
            const screen = document.querySelector('.screen');
            const obs = document.createElement('div');
            obs.className = 'obstacle';
            screen.appendChild(obs);
            
            let pos = -30;
            let loop = setInterval(() => {
                pos += 5;
                obs.style.right = pos + 'px';
                const hBot = parseInt(document.getElementById('cube-hero').style.bottom);
                if(pos > 250 && pos < 280 && hBot < 50) {
                    clearInterval(loop); obs.remove(); runActive = false;
                }
                if(pos > 350) {
                    clearInterval(loop); obs.remove(); runActive = false; addXP(1);
                }
            }, 20);
        }

        // --- GAME: HOLD ---
        let holdInt, holdVal = 0;
        window.startHold = () => {
            holdInt = setInterval(() => {
                holdVal += 2;
                document.getElementById('hold-fill').style.width = holdVal + "%";
                if(holdVal >= 100) { addXP(1); holdVal = 0; }
            }, 50);
        };
        window.stopHold = () => { clearInterval(holdInt); holdVal = 0; document.getElementById('hold-fill').style.width = "0%"; };

        // --- GAME: MATH ---
        let n1, n2, res;
        function newM() {
            n1 = Math.floor(Math.random()*15); n2 = Math.floor(Math.random()*15);
            res = n1 + n2; document.getElementById('math-quest').innerText = `${n1} + ${n2}`;
        }
        newM();
        window.checkMath = (el) => {
            if(parseInt(el.value) === res) { addXP(1); el.value = ""; newM(); }
        };
    </script>
</body>
</html>
