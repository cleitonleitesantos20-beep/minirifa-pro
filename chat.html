<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>NexusVL - Deep Chat</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700&family=Rajdhani:wght@500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --neon: #00f2ff;
            --pink: #ff0055;
            --bg: #020205;
            --border: rgba(0, 242, 255, 0.3);
        }

        * { box-sizing: border-box; margin: 0; padding: 0; -webkit-tap-highlight-color: transparent; }
        
        body { 
            background: var(--bg); 
            color: #fff; 
            font-family: 'Rajdhani'; 
            overflow: hidden; 
            height: 100vh; width: 100vw;
        }

        #city-container {
            position: fixed;
            top: 0; left: 0;
            width: 100vw; height: 100vh;
            overflow-x: scroll;
            overflow-y: hidden;
            z-index: 1;
            background: radial-gradient(circle at 50% 100%, #0a1025 0%, #020205 100%);
            scroll-behavior: smooth;
        }

        .city-svg { 
            width: 6000px; 
            height: 70%; 
            margin-top: 15vh;
            display: block; 
        }

        .building-body { fill: #05050a; stroke: var(--border); stroke-width: 1; }
        .window-node { cursor: pointer; transition: 0.3s; }
        .window-node:hover { fill: #fff; filter: drop-shadow(0 0 8px var(--neon)); }
        
        /* Bot√µes Virtuais */
        .v-button {
            position: fixed;
            width: 55px; height: 55px;
            border-radius: 50%;
            background: rgba(0, 0, 0, 0.8);
            border: 1px solid var(--neon);
            box-shadow: 0 0 10px rgba(0, 242, 255, 0.2);
            display: flex; align-items: center; justify-content: center;
            font-size: 1.2rem; z-index: 100;
            cursor: pointer; pointer-events: all;
        }

        #btn-global { bottom: 25px; left: 25px; }
        #btn-friends { bottom: 25px; left: 95px; }
        #btn-toggle { top: 25px; right: 25px; font-size: 0.7rem; font-family: 'Orbitron'; width: auto; padding: 0 15px; border-radius: 8px; }

        #chat-window {
            position: fixed;
            bottom: 95px; left: 25px;
            width: 300px; height: 350px;
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(10px);
            border: 1px solid var(--neon);
            border-radius: 15px;
            z-index: 90;
            display: none;
            flex-direction: column;
            padding: 15px;
            pointer-events: all;
        }

        .chat-messages { flex: 1; overflow-y: auto; font-size: 0.8rem; color: #ccc; }
        .chat-input-area { display: flex; gap: 10px; margin-top: 10px; border-top: 1px solid var(--border); padding-top: 10px; }
        input { background: transparent; border: none; color: #fff; outline: none; flex: 1; font-family: 'Rajdhani'; }

        @media (max-width: 600px) { #chat-window { width: 85vw; } }
    </style>
</head>
<body>

    <div class="v-button" id="btn-global" onclick="toggleChat('GLOBAL')">üåê</div>
    <div class="v-button" id="btn-friends" onclick="toggleChat('FRIENDS')">üë•</div>
    <div class="v-button" id="btn-toggle" onclick="toggleCityMode()">AGITAR CIDADE</div>

    <div id="chat-window">
        <div id="chat-title" style="font-family: 'Orbitron'; font-size: 0.6rem; color: var(--neon); margin-bottom: 8px;">GLOBAL_STREAM</div>
        <div class="chat-messages" id="chat-box"></div>
        <div class="chat-input-area">
            <input type="text" placeholder="Transmita sua mensagem..." id="chat-input">
            <button onclick="sendMsg()" style="background:none; border:none; color:var(--neon); font-weight:bold; cursor:pointer;">></button>
        </div>
    </div>

    <div id="city-container">
        <svg id="city-svg" class="city-svg" viewBox="0 0 6000 1000">
            <g id="main-layer"></g>
            <g id="traffic-layer"></g>
        </svg>
    </div>

    <script type="module">
        let agilityLevel = 1;

        document.addEventListener('DOMContentLoaded', () => {
            generateRealisticCity();
            startTraffic();
            
            // Centralizar a visualiza√ß√£o ao iniciar
            const container = document.getElementById('city-container');
            const centerX = (6000 - window.innerWidth) / 2;
            container.scrollLeft = centerX;
        });

        function generateRealisticCity() {
            const layer = document.getElementById('main-layer');
            let currentX = 50;

            while (currentX < 5900) {
                const w = 180 + Math.random() * 250;
                const h = 400 + Math.random() * 500;
                const y = 1000 - h;

                // Corpo do pr√©dio (Frente √∫nica)
                const building = document.createElementNS("http://www.w3.org/2000/svg", "rect");
                building.setAttribute("x", currentX);
                building.setAttribute("y", y);
                building.setAttribute("width", w);
                building.setAttribute("height", h);
                building.setAttribute("class", "building-body");
                layer.appendChild(building);

                // Antenas e Topo
                if(Math.random() > 0.5) {
                    const ant = document.createElementNS("http://www.w3.org/2000/svg", "line");
                    ant.setAttribute("x1", currentX + w/2); ant.setAttribute("y1", y);
                    ant.setAttribute("x2", currentX + w/2); ant.setAttribute("y2", y - 50);
                    ant.setAttribute("stroke", "var(--neon)");
                    layer.appendChild(ant);
                }

                // Janelas Realistas
                const rows = Math.floor(h / 60);
                const cols = Math.floor(w / 40);
                for(let r = 1; r < rows; r++) {
                    for(let c = 1; c < cols; c++) {
                        if(Math.random() > 0.4) {
                            const win = document.createElementNS("http://www.w3.org/2000/svg", "rect");
                            win.setAttribute("x", currentX + (c * 35));
                            win.setAttribute("y", y + (r * 50));
                            win.setAttribute("width", 10);
                            win.setAttribute("height", 15);
                            win.setAttribute("fill", Math.random() > 0.8 ? "var(--neon)" : "#1a1a25");
                            win.setAttribute("class", "window-node");
                            
                            // Algumas janelas s√£o clic√°veis
                            if(Math.random() > 0.85) {
                                win.onclick = () => alert(`FRAGMENTO DE DADOS: Bloco ${Math.floor(currentX)}`);
                            }
                            layer.appendChild(win);
                        }
                    }
                }

                currentX += w + (50 + Math.random() * 100); // Espa√ßamento entre pr√©dios
            }
        }

        function startTraffic() {
            const traffic = document.getElementById('traffic-layer');
            setInterval(() => {
                const car = document.createElementNS("http://www.w3.org/2000/svg", "rect");
                const y = 920 + (Math.random() * 40);
                car.setAttribute("x", "-50"); car.setAttribute("y", y);
                car.setAttribute("width", "35"); car.setAttribute("height", "1.5");
                car.setAttribute("fill", Math.random() > 0.5 ? "var(--neon)" : "var(--pink)");
                
                const dur = 12 / agilityLevel;
                car.style.transition = `transform ${dur}s linear`;
                traffic.appendChild(car);
                
                setTimeout(() => car.style.transform = "translateX(6100px)", 50);
                setTimeout(() => car.remove(), dur * 1000);
            }, 1200 / agilityLevel);
        }

        window.toggleChat = (type) => {
            const win = document.getElementById('chat-window');
            const title = document.getElementById('chat-title');
            if(win.style.display === 'flex' && title.innerText.includes(type)) {
                win.style.display = 'none';
            } else {
                win.style.display = 'flex';
                title.innerText = type + "_STREAM";
            }
        };

        window.toggleCityMode = () => {
            agilityLevel = agilityLevel >= 5 ? 1 : agilityLevel + 1.5;
            const msg = document.createElement('div');
            msg.style.color = "var(--pink)";
            msg.innerText = `[NEXUS]: TR√ÅFEGO EM ${Math.floor(agilityLevel * 100)}%`;
            document.getElementById('chat-box').appendChild(msg);
        };

        window.sendMsg = () => {
            const input = document.getElementById('chat-input');
            if(!input.value) return;
            const div = document.createElement('div');
            div.innerHTML = `<span style="color:var(--neon)">></span> ${input.value}`;
            document.getElementById('chat-box').appendChild(div);
            input.value = "";
        };
    </script>
    <script type="module" src="nexus-overlay.js"></script>
</body>
</html>
