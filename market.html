<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Nexus S - Global Store</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700&family=Rajdhani:wght@500;700&display=swap" rel="stylesheet">
    <style>
        :root { --neon: #00f2ff; --pink: #ff0055; --green: #00ff88; --gold: #ffcc00; --dark: #0a0a0a; }
        body { background: #000; color: #fff; font-family: 'Rajdhani'; margin: 0; padding: 0; min-height: 100vh; overflow-x: hidden; }
        
        /* HEADER FIXO */
        .header { height: 70px; display: flex; align-items: center; justify-content: space-between; padding: 0 20px; border-bottom: 1px solid #1a1a1a; position: sticky; top: 0; background: rgba(0,0,0,0.9); z-index: 100; backdrop-filter: blur(10px); }
        .user-stats { display: flex; gap: 15px; }
        .stat-mini { font-family: 'Orbitron'; font-size: 0.6rem; color: var(--green); display: flex; flex-direction: column; }
        .stat-mini span { color: #fff; font-size: 0.8rem; }

        .container { padding: 20px 0; }
        
        /* PRATELEIRAS HORIZONTAIS */
        .shelf-section { margin-bottom: 35px; }
        .shelf-title { font-family: 'Orbitron'; font-size: 0.7rem; color: var(--neon); padding: 0 20px; margin-bottom: 15px; letter-spacing: 2px; text-transform: uppercase; }
        
        .shelf-row { display: flex; overflow-x: auto; padding: 0 20px; gap: 15px; scroll-snap-type: x mandatory; scrollbar-width: none; }
        .shelf-row::-webkit-scrollbar { display: none; }

        /* CARDS DE ITEM */
        .market-card { min-width: 160px; max-width: 160px; background: #080808; border: 1px solid #1a1a1a; border-radius: 20px; padding: 15px; scroll-snap-align: start; flex-shrink: 0; transition: 0.3s; position: relative; }
        .market-card:active { transform: scale(0.95); border-color: var(--neon); }
        
        .item-icon { width: 100%; height: 80px; background: rgba(255,255,255,0.02); border-radius: 12px; margin-bottom: 12px; display: flex; align-items: center; justify-content: center; font-size: 2.2rem; border: 1px solid #111; }
        .item-name { font-family: 'Orbitron'; font-size: 0.75rem; color: #fff; display: block; margin-bottom: 5px; height: 30px; }
        .item-desc { font-size: 0.65rem; color: #555; height: 30px; line-height: 1.2; display: block; }
        
        .price-tag { font-family: 'Orbitron'; font-size: 0.85rem; color: var(--green); display: block; margin: 10px 0; }
        .btn-buy { width: 100%; background: var(--neon); color: #000; border: none; padding: 8px; border-radius: 8px; font-family: 'Orbitron'; font-size: 0.6rem; font-weight: bold; cursor: pointer; }

        /* BADGE DE XP */
        .xp-multiplier { position: absolute; top: -5px; right: -5px; background: var(--pink); color: #fff; font-size: 0.5rem; padding: 3px 6px; border-radius: 5px; font-family: 'Orbitron'; }
    </style>
</head>
<body>

    <div class="header">
        <button onclick="window.location.href='index.html'" style="background:none; border:1px solid var(--neon); color:var(--neon); padding:5px 10px; border-radius:5px; font-family:'Orbitron'; font-size:0.5rem;">VOLTAR</button>
        <div class="user-stats">
            <div class="stat-mini">SALDO <span id="u-saldo">R$ 0,00</span></div>
            <div class="stat-mini" style="color:var(--neon)">BIDS <span id="u-bids">0</span></div>
        </div>
    </div>

    <div class="container">

        <div class="shelf-section">
            <div class="shelf-title">‚ö° Pacotes de Bids</div>
            <div class="shelf-row">
                <div class="market-card">
                    <div class="item-icon">üì¶</div>
                    <span class="item-name">Starter Pack</span>
                    <span class="item-desc">10 Bids para iniciantes</span>
                    <span class="price-tag">R$ 5,00</span>
                    <button class="btn-buy" onclick="comprarItem('bids', 10, 5)">COMPRAR</button>
                </div>
                <div class="market-card">
                    <div class="item-icon">üéÅ</div>
                    <span class="item-name">Advanced Pack</span>
                    <span class="item-desc">50 Bids com desconto</span>
                    <span class="price-tag">R$ 20,00</span>
                    <button class="btn-buy" onclick="comprarItem('bids', 50, 20)">COMPRAR</button>
                </div>
                <div class="market-card">
                    <div class="item-icon">üíé</div>
                    <span class="item-name">Whale Pack</span>
                    <span class="item-desc">200 Bids + B√¥nus</span>
                    <span class="price-tag">R$ 70,00</span>
                    <button class="btn-buy" onclick="comprarItem('bids', 200, 70)">COMPRAR</button>
                </div>
            </div>
        </div>

        <div class="shelf-section">
            <div class="shelf-title">üìà Boosters de XP</div>
            <div class="shelf-row">
                <div class="market-card">
                    <div class="xp-multiplier">2x XP</div>
                    <div class="item-icon">üß™</div>
                    <span class="item-name">Po√ß√£o Azul</span>
                    <span class="item-desc">Dobre seu XP por 24h</span>
                    <span class="price-tag">R$ 10,00</span>
                    <button class="btn-buy" onclick="comprarItem('xp', 2, 10)">COMPRAR</button>
                </div>
                <div class="market-card">
                    <div class="xp-multiplier">5x XP</div>
                    <div class="item-icon">üî•</div>
                    <span class="item-name">Super Combust√≠vel</span>
                    <span class="item-desc">5x XP por 12h</span>
                    <span class="price-tag">R$ 25,00</span>
                    <button class="btn-buy" onclick="comprarItem('xp', 5, 25)">COMPRAR</button>
                </div>
                <div class="market-card">
                    <div class="xp-multiplier">MAX</div>
                    <div class="item-icon">üåü</div>
                    <span class="item-name">Ben√ß√£o da IA</span>
                    <span class="item-desc">XP M√°ximo Permanente</span>
                    <span class="price-tag">R$ 150,00</span>
                    <button class="btn-buy" onclick="comprarItem('xp', 99, 150)">COMPRAR</button>
                </div>
            </div>
        </div>

        <div class="shelf-section">
            <div class="shelf-title">üé≠ Emojis Premium</div>
            <div class="shelf-row">
                <div class="market-card">
                    <div class="item-icon">üëë</div>
                    <span class="item-name">Emoji Rei</span>
                    <span class="item-desc">Exclusivo para vips</span>
                    <span class="price-tag">R$ 15,00</span>
                    <button class="btn-buy" onclick="comprarItem('emoji', 'üëë', 15)">COMPRAR</button>
                </div>
                <div class="market-card">
                    <div class="item-icon">ü¶Ñ</div>
                    <span class="item-name">Emoji Unic√≥rnio</span>
                    <span class="item-desc">Raridade M√≠stica</span>
                    <span class="price-tag">R$ 12,00</span>
                    <button class="btn-buy" onclick="comprarItem('emoji', 'ü¶Ñ', 12)">COMPRAR</button>
                </div>
                <div class="market-card">
                    <div class="item-icon">üõ∏</div>
                    <span class="item-name">Emoji UFO</span>
                    <span class="item-desc">Viajante do tempo</span>
                    <span class="price-tag">R$ 20,00</span>
                    <button class="btn-buy" onclick="comprarItem('emoji', 'üõ∏', 20)">COMPRAR</button>
                </div>
                <div class="market-card">
                    <div class="item-icon">üè¥‚Äç‚ò†Ô∏è</div>
                    <span class="item-name">Pirata Cyber</span>
                    <span class="item-desc">Pack Explorador</span>
                    <span class="price-tag">R$ 8,00</span>
                    <button class="btn-buy" onclick="comprarItem('emoji', 'üè¥‚Äç‚ò†Ô∏è', 8)">COMPRAR</button>
                </div>
            </div>
        </div>

    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js";
        import { getFirestore, doc, onSnapshot, updateDoc, increment, arrayUnion } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore.js";
        import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-auth.js";

        const firebaseConfig = { apiKey: "AIzaSyAYO5RWaJy5y7r7jvzFk3wq-ByqM_dWWO8", authDomain: "minharifadigital.firebaseapp.com", projectId: "minharifadigital", appId: "1:59630725905:web:396c8cfca385dc3d957ab0" };
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const auth = getAuth(app);

        let userSaldo = 0;

        onAuthStateChanged(auth, user => {
            if (user) {
                onSnapshot(doc(db, "usuarios", user.uid), snap => {
                    const d = snap.data();
                    if(!d) return;
                    userSaldo = d.saldo || 0;
                    document.getElementById('u-saldo').innerText = userSaldo.toLocaleString('pt-br', {style: 'currency', currency: 'BRL'});
                    document.getElementById('u-bids').innerText = d.bids || 0;
                });
            } else { window.location.href = "login.html"; }
        });

        window.comprarItem = async (tipo, valor, preco) => {
            if (userSaldo >= preco) {
                if(confirm(`Confirmar compra de R$ ${preco},00?`)) {
                    const userRef = doc(db, "usuarios", auth.currentUser.uid);
                    
                    let updateData = { saldo: increment(-preco) };

                    if(tipo === 'bids') updateData.bids = increment(valor);
                    if(tipo === 'xp') updateData.xpMultiplier = valor;
                    if(tipo === 'emoji') updateData.emojisDesbloqueados = arrayUnion(valor);

                    await updateDoc(userRef, updateData);
                    alert("COMPRA REALIZADA COM SUCESSO!");
                }
            } else {
                alert("SALDO INSUFICIENTE! V√° para a p√°gina de Dep√≥sito.");
            }
        };
    </script>
</body>
</html>
