<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Configura√ß√µes</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="header">‚öôÔ∏è CONFIGURA√á√ïES</div>
    <div class="container">
        <button onclick="window.location.href='index.html'" class="btn-small">‚¨Ö VOLTAR</button>

        <div class="card">
            <h4>üí≥ SAQUE (M√çNIMO R$ 20,00)</h4>
            <div id="saque-info" style="text-align:center; padding:10px; border-radius:8px; margin-top:10px;"></div>
            <div id="pix-area" class="hidden">
                <input type="text" id="chave-pix" placeholder="Sua Chave PIX" style="margin-top:10px;">
                <button onclick="pedirSaque()" class="btn-primary" style="width:100%; margin-top:10px;">SOLICITAR SAQUE</button>
            </div>
        </div>

        <div class="card">
            <h4>üêû FEEDBACK</h4>
            <textarea id="feed" placeholder="Sua mensagem..." style="width:100%; height:60px; margin-top:10px; background:#000; color:#fff; border:1px solid #333;"></textarea>
            <button onclick="sendFeed()" class="btn-outline" style="width:100%; margin-top:10px;">ENVIAR</button>
        </div>

        <button onclick="logout()" class="btn-primary" style="background:#ff4444; width:100%; margin-top:20px;">SAIR DA CONTA</button>

        <p style="text-align:center; font-size:0.7rem; color:#444; margin-top:30px;">
            Idealizado por [Seu Nome]<br>Desenvolvido por uma IA Aut√¥noma.
        </p>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js";
        import { getFirestore, doc, onSnapshot, setDoc, updateDoc, increment } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore.js";
        import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-auth.js";

        const firebaseConfig = { /* Copie o config do app.js aqui */ };
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const auth = getAuth(app);

        onAuthStateChanged(auth, (u) => {
            if (u) {
                onSnapshot(doc(db, "usuarios", u.uid), (snap) => {
                    const saldo = snap.data().saldo || 0;
                    const info = document.getElementById('saque-info');
                    if(saldo >= 20) {
                        info.innerHTML = "<b style='color:#00ff88'>SAQUE LIBERADO!</b>";
                        document.getElementById('pix-area').classList.remove('hidden');
                    } else {
                        info.innerHTML = `<b style='color:#ff4444'>BLOQUEADO</b><br>Faltam R$ ${(20 - saldo).toFixed(2)}`;
                    }
                });
            } else { location.href='index.html'; }
        });

        window.logout = () => signOut(auth).then(() => location.href='index.html');
        window.sendFeed = async () => {
            const m = document.getElementById('feed').value;
            if(!m) return;
            await setDoc(doc(db, "feedbacks", Date.now().toString()), { uid: auth.currentUser.uid, msg: m });
            alert("Enviado!");
            document.getElementById('feed').value = "";
        };
        window.pedirSaque = () => alert("IA: Processando pedido... Verifique seu e-mail em 24h.");
    </script>
</body>
</html>
