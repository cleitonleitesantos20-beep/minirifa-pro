<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Configura√ß√µes - v5.0</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="header">‚öôÔ∏è CONFIGURA√á√ïES</div>
    <div class="container">
        <button onclick="window.location.href='index.html'" class="btn-small">‚¨Ö VOLTAR</button>

        <div class="card">
            <h4>üí≥ SAQUE (M√çNIMO R$ 20,00)</h4>
            <div id="saque-info" style="text-align:center; padding:15px; font-weight:bold;"></div>
            <div id="pix-area" class="hidden">
                <input type="text" id="chave-pix" placeholder="Chave PIX (CPF/E-mail/Telefone)">
                <button onclick="solicitarSaque()" class="btn-primary" style="width:100%; margin-top:10px;">SOLICITAR AGORA</button>
            </div>
        </div>

        <div class="card">
            <h4>üêû FEEDBACK</h4>
            <textarea id="feed" placeholder="Sugest√µes ou bugs..." style="width:100%; height:80px; background:#000; color:#fff; border:1px solid #333; margin-top:10px;"></textarea>
            <button onclick="enviarFeed()" class="btn-outline" style="width:100%; margin-top:10px;">ENVIAR FEEDBACK</button>
        </div>

        <button onclick="logout()" class="btn-primary" style="background:#ff4444; width:100%; margin-top:20px;">SAIR DA CONTA</button>

        <p style="text-align:center; font-size:0.7rem; color:#444; margin-top:30px;">
            Idealizado por [Seu Projeto]<br>Codificado por IA Aut√¥noma v5.0.
        </p>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js";
        import { getFirestore, doc, onSnapshot, setDoc } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore.js";
        import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-auth.js";

        const firebaseConfig = { /* Copie do app.js */ };
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const auth = getAuth(app);

        onAuthStateChanged(auth, (u) => {
            if (u) {
                onSnapshot(doc(db, "usuarios", u.uid), (snap) => {
                    const saldo = snap.data().saldo || 0;
                    const info = document.getElementById('saque-info');
                    if(saldo >= 20) {
                        info.innerHTML = "<span style='color:#00ff88'>‚úÖ SAQUE DISPON√çVEL!</span>";
                        document.getElementById('pix-area').classList.remove('hidden');
                    } else {
                        info.innerHTML = `<span style='color:#ff4444'>üîí SALDO INSUFICIENTE</span><br><small>Faltam R$ ${(20 - saldo).toFixed(2)}</small>`;
                    }
                });
            } else { location.href='index.html'; }
        });

        window.logout = () => signOut(auth).then(() => location.href='index.html');
        window.enviarFeed = async () => {
            const m = document.getElementById('feed').value;
            if(!m) return;
            await setDoc(doc(db, "feedbacks", Date.now().toString()), { uid: auth.currentUser.uid, msg: m });
            alert("Feedback enviado!");
            document.getElementById('feed').value = "";
        };
        window.solicitarSaque = () => alert("IA: Pedido em an√°lise. O processamento leva at√© 48h √∫teis.");
    </script>
</body>
</html>
